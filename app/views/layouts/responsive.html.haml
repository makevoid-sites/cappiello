:ruby
  def home_url
    "/pages/l_accademia"
  end

  def nav_link_raw(label, link, mobile:)
    url = url_for link
    unless mobile
      haml_tag(:a, href: url, class: "#{url_active url}") do
        haml_concat label
      end
    else
      # link_to label, link
      haml_tag(:a, class: "btn btn-small bg-muted color-white", href: url) do
        haml_concat label
      end
    end
  end

  def url_active(url)
    "active" if request.path == url || request.path == "/" && url == home_url
  end

  # php style


  def linkz
    {
      home: {
        label:   "L'Accademia",
        url:     home_url,
        url_en:  "/pages/about_us",
        # page: Page.find_by_url "l_accademia"
      },
      corsi: {
        label:    "Corsi",
        label_en: "Courses",
        url:      "/pag/corsi",
        url_en:   "/pag/courses",
      },
      calendario: {
        label:    "Calendario",
        label_en: "Calendar",
        url:      "/pag/calendario",
        url_en:   "/pag/calendar",
      },
      news: {
        label: "News",
        url:   [:posts],
      },
      borse_di_studio: {
        label: "Borse di Studio",
        url:  "/pages/borse_di_studio",
        # page: Page.find_by_url "borse_di_studio"
      },
      open_days: {
        label: "Open Day",
        url:  "/pages/open_days",
        # page: Page.find_by_url "open_days"
      },
      contatti: {
        label: "Contatti",
        url:  "/pages/contatti",
      }
      # add another link
      #
      # xxx: {
      #   label: "Xxxx",
      #   url:  "/pages/xxx",
      # },
    }
  end

  def nav_link(link, mobile: false)
    link = linkz.fetch link
    nav_link_raw link.fetch(:label), link.fetch(:url), mobile: mobile
  end

  def nav_link_news(mobile: false)
    nav_link "News", [:posts], mobile: mobile
  end

!!!
%html{ html_attrs(english? ? "en_EN" : "it_IT") }
  %head
    %meta{:charset => "utf-8"}/
    %meta{:content => "initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width", :name => "viewport"}/
    %link{:href => "/stylesheets/vendor/csshelper/csshelper.css", :rel => "stylesheet"}/
    %link{:href => "/stylesheets/vendor/font-awesome/font-awesome.min.css", :rel => "stylesheet"}/
    -# TODO UI salvare il font
    %link{:href => "https://fonts.googleapis.com/css?family=Open+Sans:400,700italic,700,600italic,600,400italic,300italic,300&subset=latin,cyrillic-ext", :rel => "stylesheet", :type => "text/css"}/
    = stylesheet_link_tag "main_responsive"#, :cache =>  "cache/all"
    - unless Rails.env == "production"
      - debug = " anonym_id: #{session[:anonym_id]}"
      - layout_title = site_title "#{"#{@title} - " unless @title.blank?}#{debug}"
    %title= layout_title
    %meta{ content: meta_description, name: "description"}/
    %meta{ content: meta_keywords, name: "keywords"}/
    %meta{ content: meta_author, name: "author"}/
    %meta{ name: 'csrf-token', content: form_authenticity_token}/
    %meta{ name: 'csrf-param', content: 'authenticity_token'}/
    %meta{ name: "google-site-verification", content: "WT1zivsvBTN6dzfaJhbL5JKgi5K__Te3cCcSt3VL6Uw" }/
    %meta{ property: "og:title", content: layout_title }
    %meta{ property: "og:type", content: "website" }/
    %meta{ property: "og:site_name", content: "Accademia Cappiello" }/
    %meta{ property: "og:image", content: og_image }/
    %meta{ property: "og:description", content: meta_description }/
    %meta{ property: "og:url", content: request_url }/
    %meta{ property: "fb:admins", content: "1218562195" }/
    -# TODO UI downloadare e vendorizzare
    -# %script{:src => "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js", :type => "text/javascript"}
    = javascript_include_tag "jquery", "jquery-cycle", "jquery-swfobject", "jquery-flickr", "jquery-mousewheel", "jquery-fancybox"
    = yield :head
    %script{ type: "text/javascript" }
      var action = '#{controller.action_name}'
      var resources = '#{controller.controller_name.pluralize}'
      $(function(){
      = yield :jquery
      })

  %body.bg-black{ class: "#{controller.controller_name} #{controller.action_name} #{"master" if master?} #{"admin" if admin?}"}
    / mobile menu
    %a#btnMenu.absolute.top.right.color-white.mobile.tablet.center-content.layer4{:href => "javascript:void(0)", :onclick => "$(this).toggleClass('rotate bg-primary'); $('#menuMobile').toggleClass('hide');"}
      %i.fa.fa-bars
    %a
      #menuMobile.overlay.over-y-scroll.color-white.center-content.hide.layer2
        .separator50
        .separator30
        .col6.offset-left2.radius3
          %a.btn.btn-small.bg-muted.color-white Accademia
          .separator10
          %a.btn.btn-small.bg-muted.color-white Corsi
          .separator10
          - nav_link :news, mobile: true
          %a.btn.btn-small.bg-muted.color-white Calendario
          .separator10
          %a.btn.btn-small.bg-muted.color-white Borse di Studio
          .separator10
          %a.btn.btn-small.bg-muted.color-white Open Day
          .separator10
          %a.btn.btn-small.bg-muted.color-white Contatti
          .separator15
          %a.btn.btn-smal.color-white.bg-primary Area utenti
        .separator15
        %a.color-white{:href => "#"}
          %i.fa.fa-phone
          Telefono
         
         
         
        %a.color-white{:href => "#"}
          %i.fa.fa-envelope-o
          Email
        .separator50
        .separator30
      / end mobile menu
      / social top nav
      .mobile.tablet
        .separator5
      .line-compress.bg-black.color-white
        .line-compress.top-menu.line-max
          .separator5
          .top-menu-social.col4
            %a{:href => "https://www.facebook.com/accademiaartedesigncappiello", :target => "_blank"}
              %i.fa.fa-facebook-official
            %a{:href => "http://twitter.com/Acc_Cappiello", :target => "_blank"}
              %i.fa.fa-twitter
            %a{:href => "http://instagram.com/accademiacappiello", :target => "_blank"}
              %i.fa.fa-instagram
            %a{:href => "http://www.flickr.com/photos/accademiacappiello/", :target => "_blank"}
              %i.fa.fa-pinterest
            %a{:href => "http://vimeo.com/user5798268", :target => "_blank"}
              %i.fa.fa-vimeo
            .separator3
            .separator1
          .col5.push-right
            .desktop
              .separator5
              %small
                %ul.line.right-content
                  %li.col6.right-content
                    %a.color-primary.toggle-opacity-inverse-hover{:href => "#"}
                      AREA UTENTI
                  %li.col4.right-content
                    %a.color-white.toggle-opacity-hover{:href => "#"}
                      %i.fa.fa-phone.color-white
                      Telefono
                     
                     
                    %a.color-white.toggle-opacity-hover{:href => "#"}
                      %i.fa.fa-at.color-white
                      Email
          .separator5
        .mobile.tablet
          .separator5
      / end social nav
      / header and menu
      .line.bg-white
        .separator30
        .line-compress.line-max.header
          .col2.line-tablet.center-content-tablet
            %a{:href => "/"}
              %img{:src => "data:image/png;base64,#{logo_base64}", :width => "120"}/

          .col8.center-content.desktop
            .header-menu.desktop
              .separator50
              .separator30
              - nav_link :home
              - nav_link :corsi
              - nav_link :news
              - nav_link :calendario
              - nav_link :borse_di_studio
              - nav_link :open_days
              - nav_link :contatti
        .separator15
      / end header and menu
      / slider
      .line.bg-muted-inverse
        .line-compress.line-max
          %img{:src => "http://accademia-cappiello.it/images/banner/main/pittura_creativa.png?1445262499", :width => "100%"}/
      / end slider
      / --------------content

      -# TODO UI da posizionare dove ti pare --- messaggi di errore e notifiche
      - unless flash == {} || flash.nil?
        #flashes
          - flash.map do |key, value|
            - unless value.blank?
              %div{ :class => key }= value

      -# ------------
      -# il contenuto delle pagine viene renderizzato qui! :D
      -# ------------
      = yield
      -# ------------

      #fb-root
      :javascript
        var google_conversion_id = 1048016950;
        var google_custom_params = window.google_tag_params;
        var google_remarketing_only = true;
      - unless Rails.env == "production"
        %script{:src => "//www.googleadservices.com/pagead/conversion.js", :type => "text/javascript"}
        %noscript
          %div{:style => "display:inline;"}
            %img{:alt => "", :height => "1", :src => "//googleads.g.doubleclick.net/pagead/viewthroughconversion/1048016950/?value=0&amp;guid=ON&amp;script=0", :style => "border-style:none;", :width => "1"}/
